# 个人中心角色映射为中文 实现计划

## 版本记录

| 日期 | 版本 | 修改内容 | 修改原因 |
|---|---|---|---|
| 2026-01-14 | v1.0 | 初始计划 | 基于研究报告生成 |

## 关联研究
[docs/tasks/07-个人中心角色映射为中文/2026-01-14_个人中心角色映射为中文_研究报告.md](docs/tasks/07-个人中心角色映射为中文/2026-01-14_个人中心角色映射为中文_研究报告.md)

## 功能概述
在个人中心页面中，将用户角色的英文字符串（如 'volunteer'）映射为中文显示（如 '志愿者'），以提升用户体验。角色映射基于功能文档定义，包括患者家属、志愿者、专家、管理员、维护人员。映射函数将集中管理在 `src/utils/roleMapping.js` 中。

## Phase 1: 创建角色映射工具函数

### 目标
创建 `src/utils/roleMapping.js` 文件，实现 `getRoleDisplayName` 函数，将英文角色映射为中文。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/utils/roleMapping.js|新建|创建角色映射工具文件|

### 具体变更
新建文件 `src/utils/roleMapping.js`，内容如下：

```javascript
// 角色映射表，根据功能文档定义
const roleMapping = {
  'patient_family': '患者家属',
  'volunteer': '志愿者',
  'expert': '专家',
  'admin': '管理员',
  'maintainer': '维护人员'
};

/**
 * 获取角色的中文显示名称
 * @param {string} role - 英文角色字符串
 * @returns {string} 中文显示名称，如果未找到映射则返回原字符串
 */
export function getRoleDisplayName(role) {
  return roleMapping[role] || role;
}
```

### 成功标准
- 自动验证：运行 ESLint 检查无错误。
- 手动验证：导入函数并测试映射，如 `getRoleDisplayName('volunteer')` 返回 '志愿者'。

## Phase 2: 更新个人中心页面使用映射函数

### 目标
修改 `src/pages/my/index.jsx`，在显示角色标签时使用 `getRoleDisplayName` 函数进行映射。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/pages/my/index.jsx|修改|导入映射函数并在角色显示处使用|

### 具体变更
在 `src/pages/my/index.jsx` 文件顶部添加导入：

```javascript
import { getRoleDisplayName } from '../../utils/roleMapping';
```

然后修改角色显示代码（约第28-42行）：

原代码：
```jsx
{(user?.roles || []).map((role, idx) => (
  <span
    key={role + idx}
    style={{
      display: 'inline-block',
      padding: '2px 10px',
      borderRadius: 12,
      background: '#e6f4ff',
      color: '#1677ff',
      fontSize: 13,
      marginBottom: 4,
      wordBreak: 'keep-all',
    }}
  >
    {role}
  </span>
))}
```

修改为：
```jsx
{(user?.roles || []).map((role, idx) => (
  <span
    key={role + idx}
    style={{
      display: 'inline-block',
      padding: '2px 10px',
      borderRadius: 12,
      background: '#e6f4ff',
      color: '#1677ff',
      fontSize: 13,
      marginBottom: 4,
      wordBreak: 'keep-all',
    }}
  >
    {getRoleDisplayName(role)}
  </span>
))}
```

### 成功标准
- 自动验证：运行 ESLint 检查无错误，构建成功。
- 手动验证：访问个人中心页面，角色标签显示为中文（如 '志愿者'），顺序按功能文档定义。

## Phase 3: 测试和验证

### 目标
确保角色映射功能正常工作，包括边缘情况。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|无|无|仅验证|

### 具体变更
无代码变更，仅测试。

### 成功标准
- 自动验证：运行单元测试（如果有）。
- 手动验证：测试多个角色用户、未登录用户、未知角色等情况。检查显示顺序和样式。

## PR 就绪
- Commit message: "feat: 个人中心角色映射为中文显示"
- PR 描述：实现个人中心页面角色英文到中文的映射，提升用户体验。添加角色映射工具函数，并更新页面使用。