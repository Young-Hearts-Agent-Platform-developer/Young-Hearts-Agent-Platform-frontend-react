# 个人信息页面 实现计划

## 版本记录

| 日期 | 版本 | 修改内容 | 修改原因 |
|---|---|---|---|
| 2026-01-14 | v1.0 | 初始计划 | 基于研究报告与澄清结论 |

## 关联研究
[docs/tasks/08-个人信息页面/2026-01-14_个人信息页面_研究报告.md](../../docs/tasks/08-个人信息页面/2026-01-14_个人信息页面_研究报告.md)

## 功能概述
实现“个人信息”次级页面，支持基础信息与扩展信息（志愿者/专家）分组展示，字段可编辑（弹窗），未登录时提示并引导登录。UI 风格与 ListMenu 组件一致，头像为首条，点击提示“暂不支持头像修改”。

---

## Phase 1: 新建个人信息详情页（PersonalInfo.jsx）

### 目标
新建页面，展示当前用户基础信息与扩展信息（如有），分组列表，UI 复用 ListMenu 风格。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/pages/my/PersonalInfo.jsx|新增|个人信息详情页主文件|
|src/components/ListMenu/index.jsx|复用/微调|如需支持分组或自定义项|

### 字段清单与可编辑性建议

基础信息：昵称、头像、公开邮箱
志愿者/专家：公开邮箱、是否公开、擅长领域、服务状态、title、organization、specialties
不可编辑：用户名、手机号、真实姓名、审核状态、资质证书等

#### 基础信息（User）

- 可编辑：nickname（昵称）、gender、public_email（公开邮箱，若有）、status（仅展示，不可编辑）
- 不可编辑：id、username、email（如需修改需特殊流程）、roles（仅展示）、created_at

#### 志愿者扩展（VolunteerProfile）

- 可编辑：public_email、is_public_visible、skills（擅长领域）、service_hours（仅展示）、work_status（服务状态，部分平台允许自助切换）
- 不可编辑：full_name、phone（仅管理员可见）、status（审核状态，仅展示）

#### 专家扩展（ExpertProfile）

- 可编辑：public_email、is_public_visible、title、organization、specialties（擅长领域标签）
- 不可编辑：full_name、phone、qualifications（资质证书，通常需审核上传）、status

### 具体变更
- 新建 `PersonalInfo.jsx`，按“基础信息”“志愿者/专家扩展信息”分组，字段名左对齐、内容右对齐、最右箭头。
- 头像为首条，点击弹出“暂不支持头像修改”提示。
- 复用 ListMenu 组件渲染列表，如需支持分组/自定义项可适当扩展。

### 成功标准
- 自动验证：页面可渲染，字段分组与内容正确。
- 手动验证：UI 风格与 ListMenu 一致，头像点击有提示。

---

## Phase 2: 个人中心入口跳转与未登录处理

### 目标
个人中心卡片点击跳转详情页，未登录时展示提示+登录按钮。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/pages/my/index.jsx|修改|卡片点击跳转逻辑、未登录处理|

### 具体变更
- 个人信息卡片支持点击，跳转 `/my/personal-info`。
- 未登录时，详情页展示“请先登录”提示与登录按钮，点击跳转 `/auth/login`。

### 成功标准
- 自动验证：路由跳转正常。
- 手动验证：未登录访问详情页有提示与按钮。

---

## Phase 3: 信息编辑弹窗与保存

### 目标
支持点击字段弹窗编辑（头像除外），保存后调用 API 更新。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/pages/my/PersonalInfo.jsx|修改|弹窗表单与保存逻辑|
|src/api/auth.js|如需|补充/调整 profile API 调用|

### 具体变更
- 可编辑字段点击弹窗表单，内容为当前值。
- 保存时调用 `/api/users/profile`（PUT），成功后刷新数据。
- 头像点击仅提示，不弹窗。

### 成功标准
- 自动验证：API 调用无误，数据可更新。
- 手动验证：编辑弹窗交互流畅，保存后数据刷新。

---

## Phase 4: 扩展信息动态渲染

### 目标
根据用户身份动态展示志愿者/专家扩展信息。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/pages/my/PersonalInfo.jsx|修改|扩展信息分组与渲染逻辑|
|src/store/UserContext.jsx|如需|补充扩展字段支持|

### 具体变更
- 判断用户 roles，动态渲染志愿者/专家分组及字段。
- 不同身份展示不同字段，内容与数据模型一致。

### 成功标准
- 自动验证：不同身份下字段分组正确。
- 手动验证：切换身份后页面展示符合预期。

---

## Phase 5: 验证与联调

### 目标
整体功能联调，确保各场景下体验一致。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/pages/my/PersonalInfo.jsx|联调|修正细节与异常处理|
|src/api/auth.js|联调|API 对齐|
|src/store/UserContext.jsx|联调|数据一致性|

### 具体变更
- 联调接口，处理异常与边界情况。
- 优化UI细节，确保体验一致。

### 成功标准
- 自动验证：无报错，接口联通。
- 手动验证：全流程体验流畅。

---

## Commit Message 模板

feat: 新增个人信息详情页及编辑功能，支持基础与扩展信息分组展示

## PR 描述要点
- 新增个人信息详情页，分组展示基础与扩展信息
- 支持字段弹窗编辑与保存（头像暂不支持）
- 未登录时提示并引导登录
- UI 风格与 ListMenu 组件一致
- 支持多身份扩展信息动态渲染

## 版本记录

| 日期 | 版本 | 修改内容 | 修改原因 |
|---|---|---|---|
| 2026-01-14 | v1.0 | 初始计划 | 基于研究报告与澄清结论 |
