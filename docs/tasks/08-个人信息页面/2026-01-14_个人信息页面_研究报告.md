# 个人信息页面 研究报告

## 版本记录

| 日期 | 版本 | 修改内容 | 修改原因 |
|---|---|---|---|
| 2026-01-14 | v1.0 | 初始设计 | 无 |
| 2026-01-14 | v1.1 | 明确编辑权限、头像上传与扩展信息展示结论 | 用户反馈 |

## 研究问题

1. 新建“个人信息”次级页面，若已经登录，通过在“个人中心”点击个人信息卡片进入，逐条呈现个人信息，并可以通过点击弹窗，进行修改。
2. 若没有登录，则在个人信息卡片右侧添加一个“登录”按钮，点击后跳转至登录界面。

## 发现摘要

- 当前“个人中心”页面已实现个人信息卡片展示，登录态由 `useUser` 提供，未登录时仅显示“未登录”昵称。
- 暂无独立“个人信息”次级页面文件，需新建如 `src/pages/my/PersonalInfo.jsx`。
- 用户信息获取与登录状态判断依赖 `UserContext`，API 由 `src/api/auth.js` 提供。
- 个人信息修改需弹窗表单，调用 `/api/users/profile` 接口（PUT）。
- 未登录时可在卡片右侧加“登录”按钮，跳转 `/auth/login`。

## 相关文件清单

|文件路径|作用说明|关键行号|
|---|---|---|
|src/pages/my/index.jsx|个人中心主页面，个人信息卡片展示|L1-L99|
|src/store/UserContext.jsx|用户上下文与登录态管理|L1-L60|
|src/api/auth.js|用户信息获取、登录登出API|L1-L122|
|src/components/SectionContainer/index.jsx|分区容器组件|L1-L60|
|src/components/ListMenu/index.jsx|功能列表组件|L1-L60|

## 当前实现分析

### 个人中心页面结构
- 个人信息卡片由 `infoCard` 变量渲染，展示头像、昵称、角色标签。
- 用户信息通过 `useUser` 获取，未登录时昵称显示“未登录”。
- 目前未实现点击卡片进入个人信息详情页。
- 功能列表与登出按钮独立分区。

### 登录态判断与跳转
- `UserContext` 提供 `user`、`isAuthenticated`、`login`、`logout` 等。
- 登录跳转可通过 `useNavigate` 实现：`navigate('/auth/login')`。

### 用户信息获取与修改
- `getCurrentUser` 获取当前用户信息，接口为 `/api/auth/me`。
- 修改信息需调用 `/api/users/profile`（PUT），前端需弹窗表单。

### 关键代码片段

- 个人信息卡片渲染（src/pages/my/index.jsx L18-L44）：

```jsx
<SectionContainer className="my-info-card">
  <div style={{ display: 'flex', alignItems: 'center' }}>
    <img src={user?.avatar || userAvatar} ... />
    <div style={{ flex: 1 }}>
      <div>{user ? user.nickname : '未登录'}</div>
      <div>
        {(user?.roles || []).map(...)}
      </div>
    </div>
  </div>
</SectionContainer>
```

- 登录跳转（可参考 src/pages/my/LogoutButton.jsx）：

```js
navigate('/auth/login');
```

## 架构洞察
- 用户上下文与API解耦，便于Mock与扩展。
- 个人信息卡片可复用SectionContainer，风格统一。
- 个人信息编辑建议采用弹窗表单，字段与API严格对齐。

## 潜在风险和边缘情况
- 未登录状态下误操作需友好提示。
- 用户信息字段与后端接口不一致时需兼容处理。
- 弹窗表单需校验（如邮箱、手机号等）。

## 结论与开放问题

### 明确结论
- 个人信息编辑权限**不区分角色**，所有用户均可编辑自身信息。
- 当前**不支持头像上传**，如需支持需补充API与前端实现。
- 若用户拥有对应身份（如志愿者/专家），个人信息详情页**需展示扩展信息**（如志愿者/专家Profile）。

### 仍需关注的开放问题
- 扩展信息的字段与展示规范需与后端接口进一步对齐。
- 后续如需支持头像上传，需补充接口与前端交互设计。

## 参考资料
- docs/“心青年”智能体平台-数据模型与 API 设计.md
- src/api/auth.js
- src/store/UserContext.jsx

