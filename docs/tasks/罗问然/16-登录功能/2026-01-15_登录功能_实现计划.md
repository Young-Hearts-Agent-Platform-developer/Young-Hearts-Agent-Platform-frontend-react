# 登录功能 实现计划

## 版本记录

| 日期 | 版本 | 修改内容 | 修改原因 |
|---|---|---|---|
| 2026-01-15 | v1.0 | 初始计划 | 基于 V1.1 研究报告 |

## 关联研究
[docs/tasks/16-登录功能/2026-01-15_登录功能_研究报告.md](docs/tasks/16-登录功能/2026-01-15_登录功能_研究报告.md)

## 功能概述
实现“心青年”平台前端登录功能，包括登录页 UI、登录逻辑、全局用户状态接入、路由跳转与错误处理。登录页为二级页面，仅需表单与标题。登录成功优先返回来源页，若无来源则跳转个人中心。错误提示采用常规样式。

---

## Phase 1: 登录页 UI 设计与实现

### 目标
实现简洁、无障碍的登录表单页面，风格符合全局 CSS 变量规范。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/pages/auth/Login.jsx|新增|登录页主组件|
|src/pages/auth/index.js|新增/更新|导出登录页组件|
|src/styles/variables.css|引用|引用全局样式变量|
|docs/“心青年”智能体平台-前端界面设计方案.md|参考|风格规范|

### 具体变更
- 新建 `Login.jsx`，包含用户名、密码输入框、登录按钮、标题。
- 表单样式引用 `variables.css`，保证主色、按钮、输入框风格统一。
- 支持键盘无障碍操作（Tab、Enter 提交）。

### 成功标准
- 自动验证：无 ESLint/stylelint 错误。
- 手动验证：页面展示正常，表单可交互，样式符合设计文档。

---

## Phase 2: 登录逻辑接入

### 目标
接入登录 API，处理登录态、错误提示，登录成功后写入全局 Context。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/api/auth.js|复用/补充|调用 login API，补充错误处理|
|src/store/UserContext.jsx|复用/补充|调用 login，处理登录失败|
|src/store/useUser.js|复用|消费登录状态|
|src/pages/auth/Login.jsx|更新|表单提交逻辑、错误提示|

### 具体变更
- 表单提交时调用 `login` API，成功后写入 Context。
- 登录失败时展示错误信息。
- 支持开发环境 mock 登录。

### 成功标准
- 自动验证：无未捕获异常，API 调用正常。
- 手动验证：输入错误账号/密码有提示，mock/真实 API 均可用。

---

## Phase 3: 路由注册与跳转逻辑

### 目标
注册登录页路由，实现登录后优先返回来源页，兜底跳转个人中心。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/router/（具体文件）|更新|注册 /auth/login 路由|
|src/pages/auth/Login.jsx|更新|登录成功后跳转逻辑|

### 具体变更
- 路由配置中添加 `/auth/login`。
- 登录成功后：如有来源页（history.state/from/query），优先返回；否则跳转 `/my`（个人中心）。

### 成功标准
- 自动验证：路由跳转无报错。
- 手动验证：登录后跳转符合预期。

---

## Phase 4: 验证与测试

### 目标
确保登录功能可用、体验良好。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/pages/auth/Login.jsx|测试/验证|手动与自动化测试|
|src/api/auth.js|测试/验证|mock/真实 API 测试|

### 具体变更
- 编写/补充自动化测试（如有测试框架）。
- 手动测试：正常/异常流程、跳转、样式。

### 成功标准
- 自动验证：通过所有相关测试。
- 手动验证：所有流程体验良好。

---

## Commit message 模板

feat(auth): 实现登录页 UI、登录逻辑与跳转

- 新增登录页组件与样式
- 接入登录 API 与全局用户状态
- 完善登录后跳转与错误提示

---

## PR 描述要点
- 登录页 UI 及交互实现
- 登录 API 与 Context 状态接入
- 路由注册与跳转逻辑
- 错误处理与无障碍支持

---

## 版本记录

| 日期 | 版本 | 修改内容 | 修改原因 |
|---|---|---|---|
| 2026-01-15 | v1.0 | 初始计划 | 基于 V1.1 研究报告 |
