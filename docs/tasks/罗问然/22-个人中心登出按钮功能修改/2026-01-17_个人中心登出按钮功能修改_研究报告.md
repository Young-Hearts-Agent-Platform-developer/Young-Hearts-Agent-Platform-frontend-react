# 个人中心登出按钮功能修改 研究报告

## 版本记录

| 日期 | 版本 | 修改内容 | 修改原因 |
|---|---|---|---|
| 2026-01-17 | v1.0 | 初始设计 | 新建研究任务 |

## 研究问题

修改个人中心登出按钮功能，实现：
- a. 未登录时，按钮行为与当前一致（隐藏或不可用）。
- b. 已登录时，按钮恢复正常样式，并且点击弹出“确认”弹窗，确认后执行登出操作。

## 发现摘要

- 当前登出按钮在未登录时不显示，已登录时按钮为灰色且不可点击。
- 需调整为：已登录时按钮可用，点击弹出确认框，确认后登出。
- 主要涉及 LogoutButton.jsx、LogoutButton.css 及 useUser 相关逻辑。
- 需补充弹窗组件或使用原生 confirm。

## 相关文件清单

|文件路径|作用说明|关键行号|
|---|---|---|
|src/pages/my/LogoutButton.jsx|登出按钮组件，控制显示与登出逻辑|全文件|
|src/pages/my/LogoutButton.css|登出按钮样式|全文件|
|src/store/useUser.js|用户登录状态与登出方法|相关 user, logout 逻辑|

## 当前实现分析

- LogoutButton.jsx 通过 useUser 获取 user 和 logout 方法。
- 若 user 不存在，按钮不渲染（return null）。
- 按钮样式（LogoutButton.css）为灰色、cursor: not-allowed，且按钮始终不可用。
- 点击按钮直接调用 logout 并跳转到登录页，无确认弹窗。

### 核心流程

1. 组件挂载，获取 user 状态。
2. user 不存在时 return null。
3. user 存在时渲染按钮，当前按钮为不可用状态。
4. 点击按钮直接执行 handleLogout（无确认）。

### 关键代码片段

- src/pages/my/LogoutButton.jsx

```jsx
const { user, logout } = useUser();
...
if (!user) return null;
...
<button className="logout-btn" onClick={handleLogout}>退出登录</button>
```

- src/pages/my/LogoutButton.css

```css
.logout-btn {
  ...
  background: #f5f5f5;
  color: #888;
  cursor: not-allowed;
}
```

## 架构洞察

- 按钮可用性与 user 状态强相关，建议通过 props 或状态切换样式。
- 弹窗可用原生 window.confirm 或引入通用弹窗组件。
- 登出后跳转逻辑已存在，无需变更。

## 潜在风险和边缘情况

- 弹窗交互需兼容移动端体验。
- 登出操作需防止重复点击。
- 若未来引入全局弹窗组件，需统一风格。

## 开放问题

- 是否需要自定义弹窗样式或使用现有组件库？
- 登出失败时是否需要提示？

## 参考资料

- [React 官方文档](https://react.dev/)
- [MDN window.confirm](https://developer.mozilla.org/zh-CN/docs/Web/API/Window/confirm)

