# 个人主页-信息卡与登出功能 实现计划

## 版本记录
| 日期 | 版本 | 修改内容 | 修改原因 |
|---|---|---|---|
| 2026-01-13 | v1.0 | 初始计划 | 基于研究报告与澄清需求 |

## 关联研究
[docs/tasks/06-个人主页/2026-01-13_个人主页_研究报告.md](docs/tasks/06-个人主页/2026-01-13_个人主页_研究报告.md)

## 功能概述
本计划聚焦于个人主页顶部信息卡（头像、昵称、身份标签）与登出按钮的实现。支持开发环境下通过 src/api/auth.js 切换 Mock 用户角色，身份标签采用简易样式，确保移动端适配。

---

## Phase 1: 个人信息卡 UI 及身份标签渲染

### 目标
- 在个人主页顶部展示当前用户头像（暂时不支持用户自定义头像，直接使用src\assets\user.png作为默认头像）、昵称、身份标签。
- 标签采用简易样式，支持多角色换行。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/pages/my/index.jsx|更新|实现信息卡 UI 与标签渲染|
|src/components/SectionContainer/index.jsx|复用|作为信息卡容器|

### 具体变更
- 使用 SectionContainer 包裹信息卡区域。
- Flex 布局，左侧头像，右侧昵称与标签。
- 标签遍历 user.roles，采用 span 简易样式，支持 wrap。

### 成功标准
- 自动验证：页面渲染无报错，标签可换行。
- 手动验证：切换 Mock 用户角色后，信息卡内容与标签实时刷新。

---

## Phase 2: 登出按钮实现与交互

### 目标
- 在个人主页显著位置展示登出按钮。
- 点击后清除用户状态并跳转登录页。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/pages/my/index.jsx|更新|集成登出按钮组件|
|src/pages/my/LogoutButton.jsx|复用/更新|登出逻辑与样式|

### 具体变更
- 信息卡下方或右侧展示 LogoutButton。
   - 展示条件：用户已登录（user 不为 null）。
- 登出后清除 Context 用户信息，跳转登录页。

### 成功标准
- 自动验证：登出后页面跳转无报错。
- 手动验证：点击登出后，用户信息清空，回到登录页。

---

## Phase 3: Mock 用户角色切换机制

### 目标
- 支持开发环境下通过 src/api/auth.js 切换用户角色。
- 提供醒目注释，防止误提交生产。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/api/auth.js|更新|Mock 用户对象与注释优化|

### 具体变更
- process.env.NODE_ENV === 'development' 时返回 mockUser。
- 注释块明确标识“仅开发环境使用，勿提交生产”。

### 成功标准
- 自动验证：切换 mockUser 后页面角色标签同步。
- 手动验证：注释醒目，生产环境无 mock 数据。

---

## Phase 4: Context 用户状态同步

### 目标
- 确保用户信息与权限通过 Context 全局同步。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/store/UserContext.jsx|复用/检查|Context 状态同步|
|src/store/useUser.js|复用/检查|Hook 获取用户信息|

### 具体变更
- 检查 Context 与 useUser Hook，确保信息卡与登出按钮均响应用户状态。

### 成功标准
- 自动验证：Context 更新后页面同步刷新。
- 手动验证：切换角色或登出后，信息卡与标签实时变化。

---

## PR Commit Message 模板
feat: 个人主页信息卡与登出功能实现，支持开发环境角色切换

## 版本记录
| 日期 | 版本 | 修改内容 | 修改原因 |
|---|---|---|---|
| 2026-01-13 | v1.0 | 初始计划 | 基于研究报告与澄清需求 |
