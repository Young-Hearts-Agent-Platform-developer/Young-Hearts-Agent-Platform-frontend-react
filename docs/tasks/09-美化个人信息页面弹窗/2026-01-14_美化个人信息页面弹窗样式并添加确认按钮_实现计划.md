# 美化个人信息页面弹窗样式并添加确认按钮 实现计划

## 版本记录

| 日期 | 版本 | 修改内容 | 修改原因 |
|---|---|---|---|
| 2026-01-14 | v1.0 | 初始计划 | 基于 V1 研究报告 |
| 2026-01-14 | v1.1 | 调整Phase 2 | 根据补充信息，当前弹窗无按钮，确保添加确认和取消按钮 |

## 关联研究
[docs/tasks/09-美化个人信息页面弹窗/2026-01-14_美化个人信息页面弹窗样式并添加确认按钮_研究报告.md](docs/tasks/09-美化个人信息页面弹窗/2026-01-14_美化个人信息页面弹窗样式并添加确认按钮_研究报告.md)

## 功能概述
美化个人信息页面中Modal弹窗的样式，使其契合项目主题（使用variables.css中的变量，如圆角、阴影、颜色），添加“确认”按钮（替换原“保存”），新增“取消”按钮，并实现前端验证逻辑（针对邮箱等字段，验证失败时清空输入框并在下方显示红色小字提示）。确保移动端兼容性和用户体验。（注：根据补充信息，当前弹窗无按钮，需要明确添加。）

## Phase 1: 美化弹窗样式

### 目标
更新Modal组件的样式属性，使用variables.css中的变量（如--radius-lg、--shadow-card、--color-primary等）添加圆角、阴影和主题色，保持与项目整体设计一致。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/pages/my/PersonalInfo.jsx|修改|更新Modal组件的style或className属性，应用美化样式|

### 具体变更
```diff
// 在Modal组件中添加style属性
<Modal
  visible={!!editField}
  content={renderEditInput()}
  title={editField?.label}
  closeOnMaskClick={!loading}
  onClose={() => !loading && setEditField(null)}
  confirmText="保存"
  onConfirm={handleSave}
  confirmLoading={loading}
+ style={{
+   borderRadius: 'var(--radius-lg)',
+   boxShadow: 'var(--shadow-card)',
+   backgroundColor: 'var(--color-bg)',
+   color: 'var(--color-text)'
+ }}
/>
```

### 成功标准
- 自动验证：运行eslint检查src/pages/my/PersonalInfo.jsx，无语法错误。
- 手动验证：打开个人信息页面，点击编辑字段，弹窗显示圆角、阴影和主题色，与variables.css一致。

## Phase 2: 修改按钮文本并添加取消按钮

### 目标
添加确认和取消按钮（因为当前弹窗无按钮），将confirmText从“保存”改为“确认”，并添加cancelText和onCancel属性。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/pages/my/PersonalInfo.jsx|修改|更新Modal的confirmText和添加cancelText、onCancel属性|

### 具体变更
```diff
<Modal
  visible={!!editField}
  content={renderEditInput()}
  title={editField?.label}
  closeOnMaskClick={!loading}
  onClose={() => !loading && setEditField(null)}
- confirmText="保存"
+ confirmText="确认"
+ cancelText="取消"
+ onCancel={() => !loading && setEditField(null)}
  onConfirm={handleSave}
  confirmLoading={loading}
/>
```

### 成功标准
- 自动验证：运行eslint检查src/pages/my/PersonalInfo.jsx，无语法错误。
- 手动验证：打开弹窗，显示“确认”和“取消”按钮（之前无按钮），点击“取消”关闭弹窗，点击“确认”触发保存。

## Phase 3: 添加前端验证逻辑

### 目标
针对邮箱等字段添加前端验证（格式检查），验证失败时清空输入框并在输入框下方显示红色小字提示。

### 修改文件清单
|文件路径|修改类型|说明|
|---|---|---|
|src/pages/my/PersonalInfo.jsx|修改|在renderEditInput中添加验证逻辑，更新handleSave以包含验证|

### 具体变更
```diff
// 在renderEditInput中，为邮箱字段添加验证
const renderEditInput = () => {
  // ... existing code ...
  if (editField.key === 'email') {
    return (
      <div>
        <Input
          value={editValue}
          onChange={setEditValue}
          placeholder="请输入邮箱"
        />
        {validationError && <div style={{color: 'red', fontSize: '12px'}}>{validationError}</div>}
      </div>
    );
  }
  // ... other fields ...
};

// 在handleSave中添加验证
const handleSave = async () => {
  if (editField.key === 'email' && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(editValue)) {
    setValidationError('邮箱格式不正确');
    setEditValue(''); // 清空输入框
    return;
  }
  setValidationError('');
  // ... existing save logic ...
};
```

### 成功标准
- 自动验证：运行eslint检查src/pages/my/PersonalInfo.jsx，无语法错误。
- 手动验证：编辑邮箱字段，输入无效格式，输入框清空，下方显示红色提示；输入有效格式，保存成功。

## PR 就绪
- **Commit message 模板**：feat: 美化个人信息页面弹窗样式并添加确认按钮 - [Phase X] [描述]
- **PR 描述要点**：
  - 功能：美化弹窗样式、添加确认/取消按钮、前端验证。
  - 测试：手动验证UI和逻辑，运行lint检查。
  - 影响：仅限个人信息页面，无破坏性变更。