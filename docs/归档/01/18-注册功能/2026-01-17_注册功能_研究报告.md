# 注册功能 研究报告

## 版本记录

| 日期 | 版本 | 修改内容 | 修改原因 |
|---|---|---|---|
| 2026-01-17 | v1.0 | 初始设计 | 无 |
| 2026-01-17 | v1.1 | 补充API未实现、审核逻辑、字段与流程设想 | 需求补充与API分析 |

## 研究问题

实现注册页面以及注册功能，需支持多角色注册与动态表单。

## 发现摘要

- 注册API接口（/auth/register）尚未在前端实现，后端已定义，支持多角色注册与 profile 自动创建。
- 注册成功后，普通用户（family）无需审核，志愿者（volunteer）、专家（expert）注册后为未激活状态，审核通过后激活，未激活时个人中心角色标签显示灰色。
- 注册表单需根据所选角色动态展示拓展信息，字段与规则参考API定义。
- 路由与入口已配置，页面为占位，需补充表单与逻辑。

## 相关文件清单

|文件路径|作用说明|关键行号|
|---|---|---|
|src/pages/auth/register.jsx|注册页面入口，当前为占位|L1-L10|
|src/api/auth.js|用户认证相关 API，未实现注册接口|全文件|
|src/pages/auth/login.jsx|登录页，含注册入口跳转|L106-L113|
|src/App.jsx|路由配置，注册页路由|L12, L47|
|src/types/User.js|用户数据结构，含注册状态与扩展 profile|L1-L49|
|src/store/useUser.js|用户状态管理|全文件|
|src/store/UserContext.jsx|用户上下文|全文件|
|openapi.json|后端API定义，注册接口与字段规则|/auth/register|

## 当前实现分析

- 注册页面仅有占位内容，无表单、无API调用。
- 路由已配置 `/auth/register`，可正常跳转。
- 登录页底部有“注册新账号”入口，点击跳转注册页。
- 用户API文件未实现注册接口，需补充 `/auth/register` POST 方法。
- 用户数据结构已支持多角色与 profile 扩展，审核状态字段齐全。
- 后端API已定义注册字段与规则，前端需严格对齐。

### 核心流程

```
[用户点击登录页注册入口] → [跳转注册页] → [填写基本信息] → [选择身份(可多选)] → [动态展示拓展表单] → [提交注册表单] → [调用注册API] → [注册成功/失败反馈] → [跳转登录页或提示]
```

- 普通用户注册成功即激活。
- 志愿者/专家注册后为未激活，个人中心角色标签灰色，审核通过后激活。
- 暂不考虑审核流程的用户反馈。

### 关键代码片段

- 注册页占位：
  - [src/pages/auth/register.jsx](src/pages/auth/register.jsx#L1-L10)
- 路由配置：
  - [src/App.jsx](src/App.jsx#L12), [src/App.jsx](src/App.jsx#L47)
- 登录页注册入口：
  - [src/pages/auth/login.jsx](src/pages/auth/login.jsx#L106-L113)
- 用户API文件：
  - [src/api/auth.js](src/api/auth.js)
- 用户数据结构：
  - [src/types/User.js](src/types/User.js#L1-L49)
- 后端API字段与规则：
  - [openapi.json](openapi.json#/auth/register)

## 架构洞察

- 注册API需前端补充实现，严格对齐后端字段与规则。
- 多角色注册需动态表单，基本信息为必填，身份选择后展示对应 profile 字段。
- 志愿者/专家注册后需审核，激活状态影响个人中心角色标签展示。
- 可复用登录页样式与表单组件，建议抽象表单字段与校验逻辑。

## 潜在风险和边缘情况

- 注册API未实现，表单提交无效。
- 表单校验不完善，可能导致无效或重复注册。
- 多角色拓展表单字段未覆盖或未校验。
- 审核流程未反馈，用户体验需后续完善。

## 开放问题

- 注册API前端何时补充？                在本次任务中完成
- 多角色注册的表单设计与校验如何实现？   可参考后端 API 定义，动态渲染表单字段与规则。
- 审核通过后激活的流程是否需前端提示？   不需要
- 未来角色扩展如何兼容？                暂不考虑

## 参考资料

- [src/pages/auth/register.jsx](src/pages/auth/register.jsx)
- [src/api/auth.js](src/api/auth.js)
- [src/types/User.js](src/types/User.js)
- [src/pages/auth/login.jsx](src/pages/auth/login.jsx)
- [src/App.jsx](src/App.jsx)
- [src/store/useUser.js](src/store/useUser.js)
- [src/store/UserContext.jsx](src/store/UserContext.jsx)
- [openapi.json](openapi.json)

