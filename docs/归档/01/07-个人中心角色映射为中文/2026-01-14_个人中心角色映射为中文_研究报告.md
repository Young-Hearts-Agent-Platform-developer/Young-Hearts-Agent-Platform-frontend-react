# 个人中心角色映射为中文 研究报告

## 版本记录

| 日期 | 版本 | 修改内容 | 修改原因 |
|---|---|---|---|
| 2026-01-14 | v1.0 | 初始设计 | 无 |
| 2026-01-14 | v1.1 | 确认映射函数位置、顺序和无多语言支持 | 用户确认 |

## 研究问题

在个人中心呈现角色时，将“角色”信息映射为中文

## 发现摘要

当前个人中心页面直接显示用户角色的英文字符串（如 'volunteer'），需要将其映射为中文显示（如 '志愿者'），以提升用户体验。根据功能文档，平台角色包括患者家属、志愿者、专家、管理员、维护人员。

## 相关文件清单

|文件路径|作用说明|关键行号|
|---|---|---|
|src/pages/my/index.jsx|个人中心页面，显示用户信息卡片|28-42|
|src/store/UserContext.jsx|用户上下文，提供用户信息|无直接相关|
|src/api/auth.js|MOCK用户定义，包含roles数组|8-15|
|src/pages/home/index.jsx|首页使用角色控制显示|28-30|
|docs/“心青年”智能体平台-功能文档.md|角色定义文档|199-205|

## 当前实现分析

用户角色存储在user.roles数组中，为英文字符串。目前在个人中心直接渲染这些字符串，没有任何映射。角色控制在首页等页面使用英文进行权限检查。

### 核心流程

1. 用户登录后，通过getCurrentUser获取用户信息，包括roles数组。
2. 在个人中心页面，遍历user.roles，显示每个角色标签。
3. 当前显示为英文，如 'volunteer'。

### 关键代码片段

```jsx
// src/pages/my/index.jsx L28-42
{(user?.roles || []).map((role, idx) => (
  <span
    key={role + idx}
    style={{
      display: 'inline-block',
      padding: '2px 10px',
      borderRadius: 12,
      background: '#e6f4ff',
      color: '#1677ff',
      fontSize: 13,
      marginBottom: 4,
      wordBreak: 'keep-all',
    }}
  >
    {role}
  </span>
))}
```

## 架构洞察

- 角色映射应集中管理，避免硬编码在组件中。
- 在 `src/utils/roleMapping.js` 创建映射函数，提供 `getRoleDisplayName` 函数。
- 显示顺序按照功能文档顺序：患者家属、志愿者、专家、管理员、维护人员。
- 目前仅支持中文，无需多语言扩展。

## 潜在风险和边缘情况

- 如果后端角色名称改变，前端映射需同步更新。
- 用户可能有多个角色，显示顺序需考虑。
- 未登录用户显示'未登录'，无角色。

## 开放问题

无

## 参考资料

- “心青年”智能体平台-功能文档.md：角色权限矩阵
